[env:nano_33_iot]
platform = atmelsam
board = nano_33_iot
framework = arduino

; Library dependencies - memory optimized versions
lib_deps = 
    adafruit/Adafruit GFX Library@^1.11.0
    adafruit/Adafruit ST7735 and ST7789 Library@^1.10.0
    risele/SHT3x-Arduino-Library@^1.0.0
    br3ttb/PID@^1.2.1
    paulstoffregen/Encoder@^1.4.1

; Aggressive memory optimization flags
build_flags = 
    -DARDUINO_SAMD_NANO_33_IOT
    -DARM_MATH_CM0PLUS
    -Os                                    ; Optimize for size
    -ffunction-sections                    ; Place functions in separate sections
    -fdata-sections                        ; Place data in separate sections
    -Wl,--gc-sections                      ; Remove unused sections
    -fno-exceptions                        ; Disable exceptions
    -fno-rtti                              ; Disable runtime type information
    -DSERIAL_BUFFER_SIZE=64                ; Reduce serial buffer size
    -DWIRE_BUFFER_LENGTH=32                ; Reduce I2C buffer size

; Monitor configuration
monitor_speed = 115200

; Additional optimization
board_build.extra_flags = 
    -Os
    -DENABLE_GDB_STUB=0